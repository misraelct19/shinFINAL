<!-- perfil.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil del Estudiante - SHIN</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .perfil {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .avatar-grande {
      font-size: 4rem;
      display: block;
      margin-bottom: 10px;
      text-align: center;
    }
    .logros, .nombramientos {
      margin-top: 30px;
    }
    .logro, .nombramiento {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      background: #f9f9f9;
      padding: 10px;
      border-radius: 10px;
    }
    .logro img {
      width: 100px;
      height: 100px;
      margin-right: 15px;
    }
    .volver {
      margin-top: 30px;
      text-align: center;
    }
    .btn-logros {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 20px;
    }
    .btn-logros:hover {
      background-color: #0056b3;
    }
    .fechas-lista {
      margin-top: 5px;
      font-size: 0.9rem;
      color: #555;
    }
    .fechas-lista span {
      display: block;
    }
  </style>
</head>
<body>
  <div class="perfil">
    <h2 id="nombre">Nombre del estudiante</h2>
    <span id="avatar" class="avatar-grande">🙂</span>
    <p><strong>Grado:</strong> <span id="grado"></span></p>
    <p><strong>Aikipoints:</strong> <span id="puntos">0</span></p>

    <div class="logros">
      <h3>🎖 Logros obtenidos</h3>
      <div id="lista-logros"></div>
    </div>

    <div class="nombramientos">
      <h3>👑 Nombramientos del Mes</h3>
      <div id="lista-nombramientos"></div>
    </div>

    <div class="tecnicas">
      <h3>📜 Técnicas requeridas para su siguiente examen</h3>
      <ul id="lista-tecnicas"></ul>
    </div>


    <button onclick="window.location.href='logros.html'" class="btn-logros">
      📘 Ver todos los logros disponibles
    </button>

    <div class="volver">
      <button onclick="window.location.href='index.html'">⬅ Volver al leaderboard</button>
    </div>
  </div>

  <script>
const logrosDef = [
      { nombre: "No faltar a ninguna clase en el mes", tipo: "RECURRENTE", puntos: 25 },
      { nombre: "cada técnica aprendida en omote y ura", tipo: "UNICO", puntos: 5 },
      { nombre: "aprendio los numeros del 1 al 10 en japones", tipo: "UNICO", puntos: 10 },
      { nombre: "se puede colocar el cinturón solo(a)", tipo: "UNICO", puntos: 10 },
      { nombre: "shikko adelante, atrás y con giro", tipo: "UNICO", puntos: 10 },
      { nombre: "aprendio tobu ukemi", tipo: "UNICO", puntos: 20 },
      { nombre: "aprendio todos los agarres", tipo: "UNICO", puntos: 20 },
      { nombre: "completó su primer seminario", tipo: "UNICO", puntos: 10 },
      { nombre: "asistencia a 5 seminarios", tipo: "UNICO", puntos: 20 },
      { nombre: "asistencia a 10 seminarios", tipo: "UNICO", puntos: 50 },
      { nombre: "asistencia a 20 seminarios", tipo: "UNICO", puntos: 100 },
      { nombre: "participó en su primera exhibición", tipo: "UNICO", puntos: 10 },
      { nombre: "participó en 5 exhibiciones", tipo: "UNICO", puntos: 50 },
      { nombre: "participó en 10 exhibiciones", tipo: "UNICO", puntos: 100 },
      { nombre: "participó en 20 exhibiciones", tipo: "UNICO", puntos: 200 },
      { nombre: "aprendió 20 suburis de jo", tipo: "UNICO", puntos: 50 },
      { nombre: "aprendió 7 suburi de boken", tipo: "UNICO", puntos: 20 },
      { nombre: "aprendió 3 katas de jo", tipo: "UNICO", puntos: 50 },
      { nombre: "invitó un amigo o familiar a clases de Aikido", tipo: "RECURRENTE", puntos: 5 },
      { nombre: "alcanzo 8vo kyu", tipo: "UNICO", puntos: 10 },
      { nombre: "alcanzo 7mo kyu", tipo: "UNICO", puntos: 20 },
      { nombre: "alcanzo 6to kyu", tipo: "UNICO", puntos: 40 },
      { nombre: "alcanzo 5to kyu", tipo: "UNICO", puntos: 80 },
      { nombre: "alcanzo 4to kyu", tipo: "UNICO", puntos: 160 },
      { nombre: "alcanzo 3er kyu", tipo: "UNICO", puntos: 320 },
      { nombre: "1 año de antigüedad en el dojo", tipo: "UNICO", puntos: 50 },
      { nombre: "2 años de antigüedad en el dojo", tipo: "UNICO", puntos: 100 },
      { nombre: "3 años de antigüedad en el dojo", tipo: "UNICO", puntos: 150 },
      { nombre: "5 años de antigüedad en el dojo", tipo: "UNICO", puntos: 200 },
      { nombre: "fue ponente en un seminario", tipo: "UNICO", puntos: 60 },
      { nombre: "apoyó como uke en examen por primera vez", tipo: "UNICO", puntos: 10 },
      { nombre: "apoyó como uke en examen 5 veces", tipo: "UNICO", puntos: 50 },
      { nombre: "apoyó como uke en examen 10 veces", tipo: "UNICO", puntos: 100 },
      { nombre: "apoyó como uke en examen 20 veces", tipo: "UNICO", puntos: 200 },
      { nombre: "cada exhibicion", tipo: "RECURRENTE", puntos: 10 },
      { nombre: "cada seminario", tipo: "RECURRENTE", puntos: 10 },
      { nombre: "cada examen", tipo: "RECURRENTE", puntos: 10 },
      { nombre: "cada apoyo como uke en examen", tipo: "RECURRENTE", puntos: 10 }
    ];

    const jugadores = [ 
      { nombre: "Camila Patricia Chávez Bonilla", grado: "5to KYU", avatar: "🦊", puntos: 0, asistencias:35, logros: [{
  "nombre": "No faltar a ninguna clase en el mes",
  "imagen": "img_logros/logro1.png",
  "tipo": "RECURRENTE",
  "fechas": [
    "2025-07-03",
    "2025-07-10"
  ]
},
{
  "nombre": "participó en 5 exhibiciones",
  "imagen": "img_logros/logro13.png",
  "tipo": "UNICO",
  "fechas": [
    "2025-07-18"
  ]
}], nombramientos: [{
  "titulo": "Samurai de la Disciplina",
  "fecha": ["2025-07-15","2025-08-20"]
}] },
      { nombre: "Oliver Aguirre Recio", grado: "8vo KYU", avatar: "🐯", puntos: 0, asistencias:75, logros: [], nombramientos: [] },
      { nombre: "Maximiliano Diaz de León Diaz", grado: "6to KYU", avatar: "🐸", puntos: 0, asistencias:55, logros: [], nombramientos: [] },
      { nombre: "Luis Fernando Partida Rivas", grado: "5to KYU", avatar: "🐼", puntos: 0, asistencias:12, logros: [], nombramientos: [] },
      { nombre: "Thiago Galindo López", grado: "7mo KYU", avatar: "🐨", puntos: 0,asistencias:24, logros: [], nombramientos: [] },
      { nombre: "Zía Rodríguez Recio", grado: "8vo KYU", avatar: "🦁", puntos: 0, asistencias:33, logros: [], nombramientos: [] },
      { nombre: "Ian Fabián Valdez Cárdenas", grado: "7mo KYU", avatar: "🦄", puntos: 0, asistencias:54,  logros: [], nombramientos: [] },
      { nombre: "Erick Salazar Hernández", grado: "7mo KYU", avatar: "🐻", puntos: 0,asistencias:71, logros: [], nombramientos: [] },
      { nombre: "Isaac Salazar Hernández", grado: "7mo KYU", avatar: "🐧", puntos: 0,asistencias:28,  logros: [], nombramientos: [] },
      { nombre: "Valentina Chávez Castro", grado: "6to KYU", avatar: "🦕", puntos: 0,asistencias:33,  logros: [], nombramientos: []},
      { nombre: "María José Heredia Oceguera", grado: "7mo KYU", avatar: "🦉", puntos: 0,asistencias:43, logros: [], nombramientos: [] },
      { nombre: "Monserrat Meza De La Torre", grado: "7mo KYU", avatar: "🐰", puntos: 0, asistencias:13, logros: [], nombramientos: [] },
      { nombre: "Mariano Altamirano Escobar", grado: "8vo KYU", avatar: "🦋", puntos: 0, asistencias:20, logros: [], nombramientos: [] },
      { nombre: "Ariana Celeste Ramírez Rodríguez", grado: "7mo KYU", avatar: "🐵", puntos: 0, asistencias:18, logros: [], nombramientos: [] },
      { nombre: "Kiara Lilith Ayala Soto", grado: "7mo KYU", avatar: "🐙", puntos: 0, asistencias:14, logros: [], nombramientos: [] },
      { nombre: "Diego Fierro Elenes", grado: "7mo KYU", avatar: "🦖", puntos: 0, asistencias:3, logros: [], nombramientos: [] },
      { nombre: "Victoria Gpe. Morales Cárdenas", grado: "7mo KYU", avatar: "🐮", puntos: 0, asistencias:14, logros: [], nombramientos: [] },
      { nombre: "Ximena Fierro Elenes", grado: "7mo KYU", avatar: "🐺", puntos: 0, asistencias:19, logros: [], nombramientos: [] },
      { nombre: "Raúl Alexander Aguirre Solís", grado: "", avatar: "🦕", puntos: 0, asistencias:28, logros: [], nombramientos: [] },
      { nombre: "José Luis Rangel Ruíz", grado: "", avatar: "🐔", puntos: 0, asistencias:2, logros: [], nombramientos: [] },
      { nombre: "Jason Alonzo Rangel Ruíz", grado: "", avatar: "🐢", puntos: 0, asistencias:34, logros: [], nombramientos: [] },
      { nombre: "Bernardo Vargas Zetina", grado: "5to KYU", avatar: "🐝", puntos: 0, asistencias:24, logros: [], nombramientos: [] },
      { nombre: "Sofía Isabella Sarabia De Los Santos", grado: "5to KYU", avatar: "🐙", puntos: 0, asistencias:15, logros: [], nombramientos: [] }
    ];

    const params = new URLSearchParams(window.location.search);
    const nombreParam = params.get("nombre");
    const jugador = jugadores.find(j => j.nombre === nombreParam);

    // Asistencias requeridas acumulativas por grado
const gradosProgreso = [
  { grado: "8vo KYU", total: 20 },
  { grado: "7mo KYU", total: 60 },
  { grado: "6to KYU", total: 125 },
  { grado: "5to KYU", total: 215 },
  { grado: "4to KYU", total: 335 },
  { grado: "3er KYU", total: 500 }
];

// Buscar el grado actual y el siguiente
const actualIndex = gradosProgreso.findIndex(g => g.grado === jugador.grado);
const siguienteGrado = gradosProgreso[actualIndex + 1];

if (siguienteGrado) {
 const asistenciasNecesarias = {
  "8vo KYU": 20,
  "7mo KYU": 40,
  "6to KYU": 65,
  "5to KYU": 90,
  "4to KYU": 120,
  "3er KYU": 165
};

const total = asistenciasNecesarias[siguienteGrado.grado];
const progreso = Math.min(jugador.asistencias || 0, total);
const porcentaje = Math.round((progreso / total) * 100);


  const barra = document.createElement("div");
  barra.className = "progreso";
  barra.innerHTML = `
    <h3>📈 Progreso hacia ${siguienteGrado.grado}</h3>
    <div class="barra-externa">
      <div class="barra-interna" style="width: ${porcentaje}%;"></div>
    </div>
    <p>${progreso} / ${total} asistencias (${porcentaje}%)</p>
  `;
  document.querySelector(".perfil").appendChild(barra);
}


    if (!jugador) {
      document.body.innerHTML = "<p>Estudiante no encontrado.</p>";
    } else {
      document.getElementById("nombre").textContent = jugador.nombre;
      document.getElementById("avatar").textContent = jugador.avatar;
      document.getElementById("grado").textContent = jugador.grado;

      let totalPuntos = 0;

      jugador.logros.forEach(logro => {
        const definicion = logrosDef.find(def => def.nombre === logro.nombre);
        if (definicion) {
          const veces = logro.fechas ? logro.fechas.length : 1;
          totalPuntos += definicion.puntos * veces;
        }
      });

      document.getElementById("puntos").textContent = totalPuntos;

       
  localStorage.setItem(
  'aikipoints_' + jugador.nombre,
  JSON.stringify({
    puntos: totalPuntos,
    logros: jugador.logros,
    nombramientos: jugador.nombramientos
  })
);



      const contLogros = document.getElementById("lista-logros");

      jugador.logros.forEach(logro => {
        const div = document.createElement("div");
        div.className = "logro";

        let fechasHTML = "";
        if (logro.tipo === "RECURRENTE" && logro.fechas.length > 1) {
          fechasHTML = `<div class="fechas-lista">${logro.fechas.map(f => `<span>📅 ${f}</span>`).join("")}</div>`;
        } else {
          fechasHTML = `<div class="fechas-lista"><span>📅 ${logro.fechas[0]}</span></div>`;
        }

        div.innerHTML = `
          <img src="${logro.imagen}" alt="insignia" />
          <div>
            <strong>${logro.nombre}</strong>
            ${fechasHTML}
          </div>
        `;

        contLogros.appendChild(div);
      });

      const contNombramientos = document.getElementById("lista-nombramientos");
      jugador.nombramientos.forEach(n => {
        const div = document.createElement("div");
        div.className = "nombramiento";
        div.textContent = `${n.titulo} – ${n.fecha}`;
        contNombramientos.appendChild(div);
      });
    }

    const tecnicasPorGrado = {
  "8vo KYU": [
    "Okuri ashi, Ayumi ashi, Tsugi ashi",
    "Shomen uchi, Yokomen uchi, Tsuki",
    "Ushiro ukemi, Mae ukemi",
    "Seiza, Kiza, Agura, Tate, Migi hanmi no kamae, Hidari hanmi no kamae"
  ],
  "7mo KYU": [
    "Mawari ashi, Ryoho mawari ashi, tenshin",
    "Shikko (Mae ni, Ushiro ni, ryoho mawari ashi)",
    "Ushiro yoko ukemi",
    "Tai no henka",
    "Katatedori, Ai hanmi katatedori (katate kosa dori), kata dori",
    "Ai hanmi katatedori ikkyo. OMOTE/URA",
    "Zagi kokyu ho"
  ],
  "6to KYU": [
    "Aplicación de desplazamientos contra shomen uchi",
    "Ushiro ryotekubidori, ushiro ryokatadori, ushiro eri dori, ushiro katate kubishime",
    "Mae geri, mawashi geri",
    "Katatedori uchi/ soto tenkan",
    "Shomen uchi ikkyo OMOTE/URA",
    "Katatedori sumi otoshi OMOTE/URA",
    "Katatedori uchi/soto kokyu nage",
    "Zagi kokyu ho"
  ],
  "5to KYU": [
    "Todas las formas de sujeción frontal y por la espalda",
    "Desplazamientos contra tsuki",
    "Ushiro ryotekubidori ikkyo OMOTE/URA",
    "Katatedori shiho nage OMOTE/URA",
    "Shomen uchi irimi nage OMOTE/URA",
    "Katadori, shomen uchi ikkyo – nikyo OMOTE/URA",
    "Tsuki kote gaeshi OMOTE/URA",
    "Suwari waza: katadori ikkyo – nikyo. OMOTE/URA"
  ],
  "4to KYU": [
    "Desplazamientos contra yokomen uchi",
    "Ushiro ryotekubidori kote gaeshi, kokyu nage",
    "Yokomen uchi shiho nage OMOTE/URA",
    "Shomen uchi sankyo, kote gaeshi OMOTE/URA",
    "Tsuki irimi nage OMOTE/URA",
    "Katatedori kokyu ho",
    "Morotedori kokyu nage",
    "Suwari waza: Shomen uchi ikkyo – sankyo OMOTE/URA"
  ],
  "3er KYU": [
    "Yokomen uchi irimi nage OMOTE/URA",
    "Ushiro ryotekubidori sankyo OMOTE/URA",
    "Ryotedori tenchi nage",
    "Ryotedori shiho nage OMOTE/URA",
    "Katatedori uchi/soto kaiten nage OMOTE/URA",
    "Katadori men uchi Kokyu nage",
    "Suwari waza: Shomen uchi irimi nage, kote gaeshi",
    "Hanmi handachi waza: katatedori shiho nage, katatedori uchi/soto kaiten nage OMOTE/URA",
    "Jiyu waza: Katatedori, Shomen uchi"
  ]
};

function mostrarTecnicasSiguientes() {
  const niveles = ["8vo KYU", "7mo KYU", "6to KYU", "5to KYU", "4to KYU", "3er KYU"];
  const gradoActual = jugador.grado;

  const siguienteGrado = niveles[niveles.indexOf(gradoActual) + 1];
  const tecnicas = tecnicasPorGrado[siguienteGrado];

  const lista = document.getElementById("lista-tecnicas");
  if (tecnicas) {
    tecnicas.forEach(t => {
      const li = document.createElement("li");
      li.textContent = t;
      lista.appendChild(li);
    });
  } else {
    lista.innerHTML = "<li>¡Felicidades! Este es el último grado en el sistema infantil.</li>";
  }
}

mostrarTecnicasSiguientes();

  </script>
</body>
</html>

